(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4a07dbca"],{"4630c":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("card",{attrs:{bordered:!1}},[a("template",{slot:"title"},[a("div",{staticStyle:{display:"flex"}},[a("h2",{staticStyle:{width:"100%"}},[e._v("考试列表")]),a("Button",{on:{click:function(t){e.add_exam_modal=!0}}},[e._v("添加考试")])],1),a("modal",{attrs:{loading:e.loading_add_exam},on:{"on-ok":e.submit_add_exam},model:{value:e.add_exam_modal,callback:function(t){e.add_exam_modal=t},expression:"add_exam_modal"}},[a("br"),a("br"),a("Form",{attrs:{model:e.new_exam,"label-width":100}},[a("form-item",{attrs:{label:"考试名称",required:""}},[a("Input",{model:{value:e.new_exam.exam_name,callback:function(t){e.$set(e.new_exam,"exam_name",t)},expression:"new_exam.exam_name"}})],1),a("form-item",{attrs:{label:"地点",required:""}},[a("Input",{model:{value:e.new_exam.place,callback:function(t){e.$set(e.new_exam,"place",t)},expression:"new_exam.place"}})],1),a("form-item",{attrs:{label:"开始时间",required:""}},[a("date-picker",{attrs:{type:"datetime"},on:{"on-change":e.set_start_at}})],1),a("form-item",{attrs:{label:"结束时间",required:""}},[a("date-picker",{attrs:{type:"datetime"},on:{"on-change":e.set_end_at}})],1),a("form-item",{attrs:{label:"总分",required:""}},[a("Input",{model:{value:e.new_exam.total_score,callback:function(t){e.$set(e.new_exam,"total_score",t)},expression:"new_exam.total_score"}})],1),a("form-item",{attrs:{label:"备注",required:""}},[a("Input",{model:{value:e.new_exam.note,callback:function(t){e.$set(e.new_exam,"note",t)},expression:"new_exam.note"}})],1)],1)],1)],1),a("collapse",{attrs:{accordion:""},on:{"on-change":e.open_exam}},e._l(e.exam_list,function(t){return a("panel",{key:t.id,attrs:{name:t.id}},[a("span",[e._v(e._s(t.name))]),a("div",{attrs:{slot:"content"},slot:"content"},[a("row",[a("Col",{attrs:{span:"20"}},[a("tag",{attrs:{color:"magenta"}},[e._v("地点："+e._s(t.place))]),a("tag",{attrs:{color:"orange"}},[e._v("开始时间："+e._s(t.start_at))]),a("tag",{attrs:{color:"green"}},[e._v("结束时间："+e._s(t.end_at))]),a("tag",{attrs:{color:"blue"}},[e._v("备注："+e._s(t.note))])],1),a("Col",{attrs:{span:"4"}},[a("Button",{staticStyle:{float:"right"},attrs:{type:"error"}},[e._v("删除考试")])],1)],1),a("Divider"),a("list",{attrs:{loading:e.loading_stu}},[a("template",{slot:"header"},[a("div",{staticStyle:{display:"flex","align-items":"flex-start",width:"100%"}},[a("h3",{staticStyle:{width:"100%"}},[e._v("试题列表")]),a("Button",{on:{click:function(a){e.add_pro(t.id)}}},[e._v("添加试题")]),a("modal",{attrs:{loading:e.loading_add_pro},on:{"on-ok":function(a){e.submit_add_pro(t.id)}},model:{value:e.add_pro_modal,callback:function(t){e.add_pro_modal=t},expression:"add_pro_modal"}},[a("Form",{attrs:{model:e.new_problem,"label-width":100}},[a("form-item",{staticStyle:{width:"30%"},attrs:{label:"序号",required:""}},[a("Input",{model:{value:e.new_problem.q_rank,callback:function(t){e.$set(e.new_problem,"q_rank",t)},expression:"new_problem.q_rank"}})],1),a("form-item",{attrs:{label:"题目类型",required:""}},[a("RadioGroup",{model:{value:e.new_problem.q_type,callback:function(t){e.$set(e.new_problem,"q_type",t)},expression:"new_problem.q_type"}},[a("radio",{attrs:{label:"1"}},[e._v("填空")]),a("radio",{attrs:{label:"2"}},[e._v("选择")])],1)],1),a("form-item",{attrs:{label:"题目题干",required:""}},[a("Input",{attrs:{type:"textarea",rows:3},model:{value:e.new_problem.q_title,callback:function(t){e.$set(e.new_problem,"q_title",t)},expression:"new_problem.q_title"}})],1),"2"===e.new_problem.q_type?a("form-item",{attrs:{label:"答案选项",required:""}},[a("list",{attrs:{border:"",size:"small"}},[e._l(e.new_problem.q_answers,function(t,n){return a("list-item",{key:n},[e._v("\n                      "+e._s(n)+". \n                      "),a("Input",{staticStyle:{width:"90%"},model:{value:e.new_problem.q_answers[n],callback:function(t){e.$set(e.new_problem.q_answers,n,t)},expression:"new_problem.q_answers[key]"}}),a("div",{staticStyle:{width:"10%"}},[a("a",{staticStyle:{float:"right"},on:{click:function(t){e.del_ans(n)}}},[e._v("×")])])],1)}),a("template",{slot:"footer"},[a("a",{on:{click:e.add_ans}},[e._v("添加选项")])])],2)],1):e._e(),a("form-item",{attrs:{label:"正确答案",required:""}},["2"===e.new_problem.q_type?a("checkbox-group",{model:{value:e.new_problem.right_answer,callback:function(t){e.$set(e.new_problem,"right_answer",t)},expression:"new_problem.right_answer"}},e._l(e.new_problem.q_answers,function(t,n){return a("checkbox",{key:n,attrs:{label:n}},[e._v(e._s(n))])})):a("Input",{model:{value:e.new_problem.right_answer,callback:function(t){e.$set(e.new_problem,"right_answer",t)},expression:"new_problem.right_answer"}})],1),a("form-item",{attrs:{label:"分值",required:""}},[a("Input",{staticStyle:{width:"30%"},model:{value:e.new_problem.q_mark,callback:function(t){e.$set(e.new_problem,"q_mark",t)},expression:"new_problem.q_mark"}}),e._v("\n                (剩余分值："+e._s(e.left_mark)+")")],1)],1)],1)],1)]),e._l(e.problem_list,function(n,r){return null!=n?a("list-item",{key:r},[a("span",{staticStyle:{width:"100%"}},[e._v(e._s(n.q_rank)+"."+e._s(n.q_title))]),a("template",{slot:"action"},[a("li",[a("a",{on:{click:function(t){e.q_detail(r)}}},[e._v("详细信息")]),a("modal",{model:{value:e.detail_modal,callback:function(t){e.detail_modal=t},expression:"detail_modal"}},[a("Form",{attrs:{model:e.problem_detail,"label-width":100}},[a("form-item",{attrs:{label:"序号"}},[a("span",[e._v(e._s(e.problem_detail.q_rank))])]),a("form-item",{attrs:{label:"题目"}},[a("span",[e._v(e._s(e.problem_detail.q_title))])]),a("form-item",{attrs:{label:"题目类型"}},[a("span",[e._v(e._s(e.types[e.problem_detail.type]))])]),2===e.problem_detail.type?a("form-item",{attrs:{label:"答案选项"}},[a("list",{attrs:{border:""}},e._l(e.problem_detail.q_answers,function(t,n){return a("list-item",{key:n},[e._v("\n                    "+e._s(n)+"."+e._s(t)+"\n                  ")])}))],1):e._e(),a("form-item",{attrs:{label:"正确答案"}},e._l(e.problem_detail.right_answer,function(t,n){return a("span",{key:n},[e._v(e._s(t)+"\n                    "),n<e.problem_detail.right_answer.length-1?a("Divider",{attrs:{type:"vertical"}}):e._e()],1)})),a("form-item",{attrs:{label:"分值"}},[a("span",[e._v(e._s(e.problem_detail.q_mark))])])],1)],1)],1),a("li",[a("a",{on:{click:function(t){e.del_pro_modal=!0}}},[e._v("删除")]),a("modal",{attrs:{title:"删除",loading:e.loading_del_pro},on:{"on-ok":function(a){e.del_problem(t.id,n.q_rank)}},model:{value:e.del_pro_modal,callback:function(t){e.del_pro_modal=t},expression:"del_pro_modal"}},[e._v("您确定要删除吗？")])],1)])],2):e._e()}),a("template",{slot:"footer"})],2)],1)])}))],2)},r=[],o=(a("ac6a"),a("456d"),a("cadf"),a("551c"),a("097d"),a("9afb")),l={name:"exam",data:function(){return{loading_stu:!0,add_pro_modal:!1,del_pro_modal:!1,detail_modal:!1,add_exam_modal:!1,loading_del_pro:!0,loading_add_pro:!0,loading_add_exam:!0,new_problem:{},exams:{},problems:{},problem_detail:{},new_exam:{},left_mark:0,types:{1:"填空",2:"选择"}}},methods:{open_exam:function(e){var t=this;0!==e.length&&(this.loading_stu=!0,this.problems={},Object(o["j"])(e).then(function(e){"0"===e.data.code?t.problems=e.data.data.questions:t.$Message.info("获取题目列表失败")}).catch(function(){t.$Message.info("获取题目列表失败")}),this.loading_stu=!1)},q_detail:function(e){this.problem_detail=this.problem_list[e],this.detail_modal=!0},del_problem:function(e,t){var a=this;Object(o["e"])({exam_id:e,q_rank:t}).then(function(t){"0"===t.data.code?(a.$Message.info("删除成功"),a.open_exam(e)):a.$Message.info(t.data.msg),a.del_pro_modal=!1}).catch(function(){a.$Message.info("删除失败"),a.del_pro_modal=!1})},add_ans:function(){var e={};this.new_problem.hasOwnProperty("q_answers")&&(e=this.new_problem.q_answers,delete this.new_problem.q_answers);var t=String.fromCharCode("A".charCodeAt()+Object.keys(e).length);e[t]="",this.$set(this.new_problem,"q_answers",e)},del_ans:function(e){var t=this.new_problem.q_answers;delete t[e],delete this.new_problem.q_answers,this.$set(this.new_problem,"q_answers",t)},add_pro:function(e){var t=this;this.add_pro_modal=!0,Object(o["i"])(e).then(function(e){"0"===e.data.code&&(t.left_mark=e.data.data.left_score)})},submit_add_pro:function(e){var t=this;this.new_problem.exam_id=e,Object(o["c"])(this.new_problem).then(function(a){"0"===a.data.code?(t.$Message.info("添加成功"),t.add_pro_modal=!1,t.open_exam(e)):t.$Message.info("添加失败")}).catch(function(){t.$Message.info("添加失败")})},submit_add_exam:function(){var e=this;Object(o["b"])(this.new_exam).then(function(t){"0"===t.data.code?(e.$Message.info("添加成功"),e.add_exam_modal=!1,e.refreshExam()):e.$Message.info("添加失败")}).catch(function(){e.$Message.info("添加失败")})},refreshExam:function(){var e=this;Object(o["h"])({}).then(function(t){"0"===t.data.code?e.exams=t.data.data:e.$Message.info("获取考试列表失败")}).catch(function(){e.$Message.info("获取考试列表失败")})},set_start_at:function(e){this.new_exam.start_at=e},set_end_at:function(e){this.new_exam.end_at=e}},computed:{exam_list:function(){var e=[];for(var t in this.exams){var a=this.exams[t][0];a["id"]=t,e.push(a)}return e},problem_list:function(){var e=this.problems,t=[];for(var a in e){var n=e[a][0];n.id=a,t[n.q_rank]=n}return t}},watch:{add_pro_modal:function(){this.new_problem={}}},mounted:function(){this.refreshExam()}},s=l,i=(a("c56d"),a("2877")),d=Object(i["a"])(s,n,r,!1,null,"2fc3b5a8",null);d.options.__file="exam.vue";t["default"]=d.exports},8327:function(e,t,a){},"9afb":function(e,t,a){"use strict";a.d(t,"m",function(){return o}),a.d(t,"g",function(){return l}),a.d(t,"l",function(){return s}),a.d(t,"h",function(){return i}),a.d(t,"j",function(){return d}),a.d(t,"e",function(){return _}),a.d(t,"i",function(){return m}),a.d(t,"c",function(){return c}),a.d(t,"f",function(){return u}),a.d(t,"a",function(){return p}),a.d(t,"d",function(){return f}),a.d(t,"b",function(){return b}),a.d(t,"k",function(){return h});a("cadf"),a("551c"),a("097d");var n=a("66df"),r="teacher",o=function(e){var t=e.passwd;return n["a"].request({url:r+"/setpasswd",data:{passwd:t},method:"post"})},l=function(e){var t=e.c_id,a=void 0===t?null:t;return n["a"].request({url:r+"/getclass",data:{c_id:a},method:"post"})},s=function(e){return n["a"].request({url:r+"/liststd",data:{c_id:e},method:"post"})},i=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return n["a"].request({url:r+"/listexam",data:{exam_id:e},method:"post"})},d=function(e){return n["a"].request({url:r+"/listques",data:{exam_id:e},method:"post"})},_=function(e){var t=e.exam_id,a=e.q_rank;return n["a"].request({url:r+"/delques",data:{exam_id:t,q_rank:a},method:"post"})},m=function(e){return n["a"].request({url:r+"/leftscore",data:{exam_id:e},method:"post"})},c=function(e){return n["a"].request({url:r+"/addques",data:e,method:"post"})},u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return n["a"].request({url:r+"/listlink",data:{class_id:e,exam_id:t},method:"post"})},p=function(e){var t=e.class_id,a=e.exam_id;return n["a"].request({url:r+"/linkexam",data:{class_id:t,exam_id:a},method:"post"})},f=function(e){var t=e.class_id,a=e.exam_id;return n["a"].request({url:r+"/dellink2",data:{class_id:t,exam_id:a},method:"post"})},b=function(e){return n["a"].request({url:r+"/addexam",data:e,method:"post"})},h=function(e,t){return n["a"].request({url:r+"/gettotalscore",data:{class_id:e,exam_id:t},method:"post"})}},c56d:function(e,t,a){"use strict";var n=a("8327"),r=a.n(n);r.a}}]);